<html>
<head>

<!-- JQuery -->
<script
  src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous"></script>

<!-- JQuery DataTables -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.css"/>
 
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.js"></script>

<!--Bootstrap -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>



<style>
.content {
	width:85%;
   margin-left: 7.5%;
    padding: 10px;
}
</style>


</head>
<body>


<div class="content">

	<!-- Navbar -->
	<nav class="navbar navbar-inverse bg-inverse">
		
		<form method = "post">
			<input type="submit" value="Home" style = "background-color: Transparent; border: none; color: white;" onclick="form.action='goHome';"/>
			<input type="submit" value="Profile" style = "background-color: Transparent; border: none;  color: white;" onclick="form.action='goProfile';"/>
			<input type="submit" value="Logout" style = "background-color: Transparent; border: none;  color: white;" onclick="form.action='logout';"/>
		</form>

    </nav>

	 <h2>Welcome ${name}!</h2>
 	<br>
 	<br>
 	<br>
	
	<h3>Requests</h3>
	<!-- Request Table -->
	<table  class="table" cellpadding="0" cellspacing="0" border="0" id="tableId">
		<thead>
		<tr>
			<th>ID</th>
			<th>Status</th>
			<th>Amount</th>
			<th>Purpose</th>
			<th>Requested</th>
			<th>Resolved</th>
			<th>Requester</th>
			<th>Resolver</th>
			<th>Note</th>
		</tr>
		</thead>
	</table>
	
	
	<br>
	<br>
	<br>
	<br>
	
	<h3>Employees</h3>
	<!-- Employee Table -->
	<table  class="table" cellpadding="0" cellspacing="0" border="0" id="eTable">
		<thead>
		<tr>
			<th>ID</th>
			<th>First Name</th>
			<th>Last Name</th>
			<th>Is Manager</th>
			<th>E-Mail</th>
		</tr>
		</thead>
	</table>
	
	<#if add! == "fail">
	<h5 style="color:red">Employee already exists or email is in use.</h5>
	</#if>
	


  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Add Employee</button>

  <!-- Add Employee -->
  <div class="modal fade" id="myModal" role="dialog" data-backdrop="static">
    <div class="modal-dialog">
    
    
    
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">New Request</h4>
        </div>
        <div class="modal-body">
          <form name = "requestForm" action="addRequest" method="post">
			Amount <br>
			<input type = "number" step=".01" name ="amount" min=".01" required = required/> <br>
			Purpose <br>
			<input type = "text" name = "purp" required = required maxlength="300"/> 
			<br>
			<input type="submit" value="submit"/>
			</form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>


  <!-- Modal Accept and Deny -->
  <div class="modal fade" id="myModal" role="dialog" data-backdrop="static">
    <div class="modal-dialog">
    
      
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Approve/Deny Request</h4>
        </div>
        <div class="modal-body">
          <form name = "resolveForm" action="resolve" method="post">
			ID <br>
			<input type = "number" id = "rid" name ="id"  value = "0" readonly> <br>
			Note <br>
			<input type = "text" name = "note" required = required maxlength="300"/> 
			<br>
			  <input type="radio" name="stat" value="accepted" checked> Accept<br>
  			<input type="radio" name="stat" value="denied"> Deny
  			<br>
			<input type="submit" value="submit"/>
			</form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
	
</div>

	<script>

	$(document).ready(function() 
	{
	var table = $('#tableId').dataTable( 
	{
	"processing": true,
	"ajax": {
	"url": "/ERS/displayRequets",
	"dataSrc": "demo",
	"type": "POST"
	}
	});
	
	var table2 = $('#eTable').dataTable( 
	{
	"processing": true,
	"ajax": {
	"url": "/ERS/displayEmployees",
	"dataSrc": "demo",
	"type": "POST"
	}
	});
	
	$('#tableId tbody').on( 'click', 'tr', function () {
        if ( $(this).hasClass('selected') ) {
            $(this).removeClass('selected');
        }
        else {
            table.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
            
           var x = parseInt($('.selected :first-child').text());
        
        	var stat = $('.selected :first-child').next().text();
        	
        
        	if(stat == "pending")
        	{
        		 $('#myModal').modal('show');
          		 $('#rid').val(x);
        	}
           
        }
    });
	
	});
	
	
	</script>


</body>
</head>