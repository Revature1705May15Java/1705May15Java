package com.bank.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.bank.pojos.User;
import com.bank.util.ConnectionUtil;

public class DaoImpl implements DAO{
	public User addUser(User user) {
		try (Connection connect = ConnectionUtil.getConnection();) {
			String sql = "INSERT INTO Bank_User (first_name, last_name, user_name, password, email)"
					+ "VALUES (?, ?, ?, ?, ?)";
			String generatedColumns[] = { "user_id" };
			PreparedStatement ps = connect.prepareStatement(sql, generatedColumns);
			ps.setString(1, user.getFirstName());
			ps.setString(2, user.getLastName());
			ps.setString(3, user.getUsername());
			ps.setString(4, user.getPassword());
			ps.setString(5, user.getEmail());
			
			int row = ps.executeUpdate();
			if (row == 1) {
				ResultSet rs = ps.getGeneratedKeys();
				if (rs.next()) {
					int id = rs.getInt(1);
					user.setId(id);
				}
			}
			return user;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}
}
