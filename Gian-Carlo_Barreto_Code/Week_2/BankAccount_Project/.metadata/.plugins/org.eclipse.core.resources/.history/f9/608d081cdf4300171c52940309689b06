package com.bank.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.bank.pojos.User;
import com.bank.util.ConnectionUtil;

public class DaoImpl implements DAO {
	
	/**
	 * Adds a user to the Bank_User table
	 * @param user
	 * @return the user that was added
	 */
	public User addUser(String firstName, String lastName, String username, String password, String email) {
		User user = new User();
		try (Connection connect = ConnectionUtil.getConnection();) {
			String sql = "INSERT INTO Bank_User (first_name, last_name, user_name, password, email)"
					+ "VALUES (?, ?, ?, ?, ?)";
			String generatedColumns[] = { "user_id" };
			PreparedStatement ps = connect.prepareStatement(sql, generatedColumns);
			ps.setString(1, firstName);
			ps.setString(2, lastName);
			ps.setString(3, username);
			ps.setString(4, password);
			ps.setString(5, email);
			
			int row = ps.executeUpdate();
			if (row == 1) {
				ResultSet rs = ps.getGeneratedKeys();
				if (rs.next()) {
					int id = rs.getInt(1);
					user.setId(id);
					user.setFirstName(firstName);
					user.setLastName(lastName);
					user.setUsername(username);
					user.setPassword(password);
					user.setEmail(email);
				}
			}
			return user;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}
}
