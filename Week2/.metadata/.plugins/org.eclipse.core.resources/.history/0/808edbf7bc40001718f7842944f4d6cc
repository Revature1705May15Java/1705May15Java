package com.ex.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;

import com.ex.util.ConnectionUtil;

public class DaoImpl {

	/*
	 * STATEMENT to update
	 * adds order to demo_orders table
	 */
	public void addOrder(int cust_id, double total){

		try(Connection connection = ConnectionUtil.getConnection();){


			String sql = "insert into demo_orders(customer_id, order_total) "
					+ "values(" + cust_id + ", " + total + ")";
			Statement statement = connection.createStatement();

			int numRowsAffected = statement.executeUpdate(sql);
			System.out.println("Num rows affected: " + numRowsAffected);

		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	/*
	 * PREPARED STATEMENT used to update
	 * adds customer to demo_customers table
	 */
	
	public void addCustomer(String fn, String ln, String state, double credit, String email){
		
		try(Connection connection = ConnectionUtil.getConnection();){
			
			String sql = "insert into demo_customers"
					+ " (cust_first_name, cust_last_name, cust_state,"
					+ " credit_limit, cust_email) "
					+ "values(?, ?, ?, ?, ?)";
			PreparedStatement ps = connection.prepareStatement(sql);
			ps.setString(1, fn);
			ps.setString(2, ln);
			ps.setString(3,state);
			ps.setDouble(4, credit);
			ps.setString(5, email);
			
			int num = ps.executeUpdate();
			System.out.println("num rows affected " + num);
			
			
			
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	/*
	 * PREPARED STATEMENT TO EXECUTE QUERY
	 */
	
	

}
